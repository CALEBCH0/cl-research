# Complete backbone comparison on SmartEye IR face dataset with SLDA
name: backbone_comparison
description: Compare all available backbone architectures using SLDA on SmartEye faces

vary:
  model:
    # Standard Computer Vision Models
    # ==============================
    
    # EfficientNet Family (Lightweight to Medium)
    - name: efficientnet_b0
      type: efficientnet_b0
      params:
        pretrained: true
        
    - name: efficientnet_b1
      type: efficientnet_b1
      params:
        pretrained: true
        
    - name: efficientnet_b2
      type: efficientnet_b2
      params:
        pretrained: true
        
    - name: efficientnet_b3
      type: efficientnet_b3
      params:
        pretrained: true
        
    - name: efficientnet_b4
      type: efficientnet_b4
      params:
        pretrained: true
        
    # ResNet Family
    - name: resnet18
      type: resnet18
      params:
        pretrained: true
        
    - name: resnet34
      type: resnet34
      params:
        pretrained: true
        
    - name: resnet50
      type: resnet50
      params:
        pretrained: true
        
    # MobileNet Family
    - name: mobilenet_v2
      type: mobilenet_v2
      params:
        pretrained: true
        
    - name: mobilenet_v3_large
      type: mobilenet_v3_large
      params:
        pretrained: true
        
    - name: mobilenet_v3_small
      type: mobilenet_v3_small
      params:
        pretrained: true
        
    # DenseNet Family
    - name: densenet121
      type: densenet121
      params:
        pretrained: true
        
    - name: densenet161
      type: densenet161
      params:
        pretrained: true
        
    - name: densenet169
      type: densenet169
      params:
        pretrained: true
        
    - name: densenet201
      type: densenet201
      params:
        pretrained: true
        
    # VGG Family
    - name: vgg11
      type: vgg11
      params:
        pretrained: true
        
    - name: vgg13
      type: vgg13
      params:
        pretrained: true
        
    - name: vgg16
      type: vgg16
      params:
        pretrained: true
        
    - name: vgg19
      type: vgg19
      params:
        pretrained: true
        
    # Custom Face Recognition Models
    # ==============================
    
    # GhostFaceNetV2 variants
    - name: ghostface_112_small
      type: ghostfacenetv2
      params:
        image_size: 112
        num_features: 256
        width: 0.5  # Small variant
        
    - name: ghostface_112_medium
      type: ghostfacenetv2
      params:
        image_size: 112
        num_features: 256
        width: 1.0  # Standard variant
        
    - name: ghostface_112_large
      type: ghostfacenetv2
      params:
        image_size: 112
        num_features: 512
        width: 1.3  # Large variant
        
    # Modified MobileFaceNet
    - name: mobilefacenet
      type: modified_mobilefacenet
      params: {}
        
    # DWSeesawFaceV2
    - name: dwseesawface
      type: dwseesawfacev2
      params: {}
        
    # Basic Models (for comparison)
    # ============================
    
    # Simple MLP
    - name: mlp
      type: mlp
      params:
        hidden_size: 512
        hidden_layers: 3
        
    # Simple CNN
    - name: cnn
      type: cnn
      params: {}

fixed:
  # Fixed strategy - SLDA (excellent for face recognition)
  strategy:
    name: slda
    type: slda
    params:
      shrinkage_param: 0.0001
      streaming_update_sigma: true
      
  # Fixed dataset - SmartEye IR faces
  dataset:
    name: smarteye_crop
    is_predefined: true
    path: /home/dylee/data/data_fid/FaceID/ARM
    # n_experiences: FIXED AT 17 (1 identity per experience)
    test_split: 0.2
    use_cache: true  # Use cached dataset splits for faster loading
    preload_to_memory: false  # Memory efficient loading
    
  # Training configuration optimized for SLDA
  training:
    epochs_per_experience: 1  # SLDA typically uses 1 epoch
    batch_size: 16  # May need to reduce for larger models if OOM
    lr: 0.001
    optimizer: adam
    
  # Experiment configuration
  experiment:
    seeds: [42]  # Single seed for faster comparison, can add more later
    device: cuda
    save_checkpoints: false

# Expected Results:
# ================
# Standard Models (pretrained on ImageNet):
# - EfficientNet B0-B4: Should achieve ~99% (proven to work)
# - ResNet variants: Should achieve high accuracy with different efficiency
# - MobileNet variants: Faster inference, potentially slightly lower accuracy
# - DenseNet: High accuracy but slower
# - VGG: Baseline comparison
#
# Custom Face Models:
# - GhostFaceNetV2: Face-optimized, should achieve ~99%
# - MobileFaceNet: Mobile-optimized for faces, should achieve ~99%  
# - DWSeesawFaceV2: Efficient face model, should achieve ~99%
#
# Basic Models:
# - MLP: Baseline comparison (likely lower accuracy)
# - CNN: Simple CNN baseline
#
# Model Efficiency Ranking (Expected):
# 1. MobileNet variants (fastest)
# 2. EfficientNet B0-B1 (good balance) 
# 3. Custom face models (face-optimized)
# 4. ResNet variants (medium speed)
# 5. DenseNet/VGG (slower)
#
# Accuracy Ranking (Expected):
# 1. Custom face models (~99%)
# 2. EfficientNet B2-B4 (~99%)
# 3. ResNet/DenseNet (~95-99%)
# 4. EfficientNet B0-B1 (~95-99%)
# 5. MobileNet variants (~90-95%)
# 6. Basic models (~70-85%)