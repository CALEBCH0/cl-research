# Lightweight backbone comparison on SmartEye IR face dataset with SLDA
name: backbone_comparison
description: Compare lightweight backbone architectures using SLDA on SmartEye faces

vary:
  model:
    # Lightweight Standard Models
    # ===========================
    
    # EfficientNet Family (Small variants only)
    - name: efficientnet_b0
      type: efficientnet_b0
      params:
        pretrained: true
        
    - name: efficientnet_b1
      type: efficientnet_b1
      params:
        pretrained: true
        
    # ResNet Family (Smallest only)
    - name: resnet18
      type: resnet18
      params:
        pretrained: true
        
    # MobileNet Family (All are lightweight)
    - name: mobilenet_v2
      type: mobilenet_v2
      params:
        pretrained: true
        
    - name: mobilenet_v3_small
      type: mobilenet_v3_small
      params:
        pretrained: true
        
    # Note: DenseNet121 and VGG11 removed due to OOM errors with SLDA
    # Their feature dimensions (1024 and 4096) require too much GPU memory for covariance matrices
        
    # Custom Face Recognition Models
    # ==============================
    
    # GhostFaceNetV2 (Small variant only)
    - name: ghostface_112_small
      type: ghostfacenetv2
      params:
        image_size: 112
        num_features: 256
        width: 0.5  # Small variant
        
    # Modified MobileFaceNet
    - name: mobilefacenet
      type: modified_mobilefacenet
      params: {}
        
    # DWSeesawFaceV2
    - name: dwseesawface
      type: dwseesawfacev2
      params: {}
        
    # Basic Models (for comparison)
    # ============================
    
    # Simple MLP
    - name: mlp
      type: mlp
      params:
        hidden_size: 512
        hidden_layers: 3
        
    # Simple CNN
    - name: cnn
      type: cnn
      params: {}

fixed:
  # Fixed strategy - SLDA (excellent for face recognition)
  strategy:
    name: slda
    type: slda
    params:
      shrinkage_param: 0.0001
      streaming_update_sigma: true
      
  # Fixed dataset - SmartEye IR faces
  dataset:
    name: smarteye_crop
    is_predefined: true
    path: /home/dylee/data/data_fid/FaceID/ARM
    # n_experiences: FIXED AT 17 (1 identity per experience)
    test_split: 0.2
    use_cache: true  # Use cached dataset splits for faster loading
    preload_to_memory: false  # Memory efficient loading
    
  # Training configuration optimized for SLDA
  training:
    epochs_per_experience: 1  # SLDA typically uses 1 epoch
    batch_size: 16  # May need to reduce for larger models if OOM
    lr: 0.001
    optimizer: adam
    
  # Experiment configuration
  experiment:
    seeds: [42]  # Single seed for faster comparison, can add more later
    device: cuda
    save_checkpoints: false

# Model Summary (11 models total):
# ================================
# Standard Models (5):
# - EfficientNet: B0, B1 (smallest variants)
# - ResNet: 18 (smallest)
# - MobileNet: V2, V3-Small (both lightweight)
# Note: DenseNet121 and VGG11 removed due to OOM errors
#
# Custom Face Models (3):
# - GhostFaceNetV2: Small variant only
# - MobileFaceNet: Mobile-optimized
# - DWSeesawFaceV2: Efficient face model
#
# Basic Models (2):
# - MLP: Simple baseline
# - CNN: Simple convolutional baseline
#
# Expected Performance:
# ====================
# High Accuracy (95-100%):
# - EfficientNet B0, B1
# - ResNet18
#
# Good Accuracy (85-95%):
# - MobileNet variants
# - Custom face models (should be higher but currently underperforming)
#
# Baseline (70-90%):
# - MLP
# - CNN
#
# Memory Usage (Expected):
# - All remaining models should fit in 11GB GPU memory
# - Batch size 16 should work for all models
# - DenseNet121 and VGG11 removed due to excessive memory requirements